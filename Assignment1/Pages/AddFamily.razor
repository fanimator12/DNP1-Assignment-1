@page "/AddFamily"
@attribute [Authorize(Policy = "MustBeLoggedIn")]

@using Assignment1.Models;
@using Assignment1.Data
@inject IFamiliesService FamilyService
@inject NavigationManager NavigationManager

<h3>Add Family</h3>
<p>This page can only be viewed, if you are logged in.</p>

<EditForm Model="@newFamilyItem" OnValidSubmit="@AddNewFamily">
    <DataAnnotationsValidator/>
    <ValidationSummary/>
    <div class="form-group">
        Id:<br/>
        <InputNumber @bind-Value="newFamilyItem.Id"/>
    </div>
    <div class="form-group">
        Add Adult:<br/>
        <InputTextArea @bind="newFamilyItem.Adults"/>
    </div>
    <p class="actions">
        <button class="btn btn-outline-dark" type="submit">Add Another</button>
    </p>
    <div class="form-group">
        Add Adult:<br/>
        <InputTextArea @bind="newFamilyItem.Adults"/>
    </div>
    <div class="form-group">
        Street Name:<br/>
        <InputTextArea rows="4" @bind-Value="newFamilyItem.StreetName"/>
    </div>
    <div class="form-group">
        House Number:<br/>
        <InputNumber @bind-Value="newFamilyItem.HouseNumber"/>
    </div>
    <div class="form-group">
        Children:<br/>
        <InputTextArea @bind="newFamilyItem.Children"/>
    </div>
    <div class="form-group">
        Pets:<br/>
        <InputTextArea @bind="newFamilyItem.Pets"/>
    </div>
    <p class="actions">
        <button class="btn btn-outline-dark" @onclick="AddNewFamily" type="submit">Create</button>
    </p>
</EditForm>

@code {
    private Family newFamilyItem = new Family();
    private Person newAdult = new Person();

    private void AddNewFamily() {
        FamilyService.AddFamily(newFamilyItem);
        NavigationManager.NavigateTo("/Families");
    }

    private void AddNewAdult() {
        FamilyService.AddAdult(newAdult);
        NavigationManager.NavigateTo("/Adults");
    }
}